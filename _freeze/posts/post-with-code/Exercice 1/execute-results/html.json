{
  "hash": "05b7386cd5a082e43850f9e79b36fbc9",
  "result": {
    "markdown": "---\ntitle: \"Exercice 1\"\nauthor: \"Valorys Trillaud\"\ndate: \"2024-03-04\"\ncategories: [news, analysis]\n---\n\n\n# Exercice semaine 1\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(geosphere)\nlibrary(tidygeocoder)\nlibrary(stringr)\n```\n:::\n\n\n## Question 2\n\nLisez le fichier exo_1_ex.txt avec la fonction read.table. Le résultat sera affecté à l'objet de nom data_ex. Le jeux de données contient 4 colonnes. Quels sont les noms et la nature des colonnes ? Combien de lignes contient la data.frame ?\n\n### Lecture du fichier :\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndata_ex <- read.csv(\"C:/Users/valor/OneDrive/Bureau/Master 1/Semestre 2/R avancé et GitHub/cours_R_avance/data/data_base/paris-2024-sites-olympiques-et-paralympiques-franciliens.csv\", sep = \";\", header = TRUE)\n```\n:::\n\n\n### Noms et nature des colonnes :\n\n\n::: {.cell}\n\n```{.r .cell-code}\n#Noms des colonnes\nnames(data_ex)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"geo_point\"                      \"nom\"                           \n[3] \"sites_olympiques_paralympiques\" \"sports\"                        \n```\n:::\n\n```{.r .cell-code}\n#Nature colonnes\nsapply(data_ex, class)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n                     geo_point                            nom \n                   \"character\"                    \"character\" \nsites_olympiques_paralympiques                         sports \n                   \"character\"                    \"character\" \n```\n:::\n:::\n\n\nLes noms des colonnes geo_point, nom, sites_olympiques et sports. La nature des quatre colonnes est character.\n\n### Nombres de lignes :\n\n\n::: {.cell}\n\n```{.r .cell-code}\n#Nombres de lignes\nnrow(data_ex)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 31\n```\n:::\n:::\n\n\nIl y a 31 lignes.\n\n## Question 3\n\n### Nombre de sites olympiques :\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsum(grepl(\"Site olympique\", data_ex$sites_olympiques_paralympiques))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 26\n```\n:::\n:::\n\n\nIl y a 26 sites olympiques.\n\n## Question 4\n\n### Nombre de sites paralympiques\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsum(grepl(\"Site paralympique\", data_ex$sites_olympiques_paralympiques))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 19\n```\n:::\n:::\n\n\nIl y a 19 sites paralympiques.\n\n## Question 5\n\n### Sites qui accueillent plusieurs disciplines sportives:\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndata_ex$nom[grep(\",\", data_ex$sports)]\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n [1] \"Stade de France\"                                \n [2] \"Vélodrome National de Saint-Quentin-en-Yvelines\"\n [3] \"Stade Roland Garros\"                            \n [4] \"Arena Paris Sud 4 (Porte de Versailles)\"        \n [5] \"Pont d'Iéna\"                                    \n [6] \"Arena Bercy\"                                    \n [7] \"Arena Paris nord\"                               \n [8] \"Arena Paris Sud 6 (Porte de Versailles)\"        \n [9] \"Stade de la Concorde\"                           \n[10] \"Arena Champs de Mars\"                           \n[11] \"La Défense Arena\"                               \n[12] \"Stade nautique\"                                 \n[13] \"Arena Paris Sud 1 (Porte de Versailles)\"        \n[14] \"Stade Tour Eiffel\"                              \n[15] \"Arena La Chapelle\"                              \n[16] \"Centre aquatique\"                               \n[17] \"Château de Versailles\"                          \n[18] \"Grand Palais\"                                   \n[19] \"Invalides\"                                      \n```\n:::\n:::\n\n\n## Question 6\n\n### Disciplines para-olympiques accueillies dans les sites franciliens\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndata_ex$sports_para <- sapply(strsplit(data_ex$sports, \",\"), function(sports) {\n  para_sports <- grep(\"Para|fauteuil|Cécifoot|assis|Goalball|Boccia\", sports, value = TRUE)\n  if (length(para_sports) > 0) paste(para_sports, collapse = \",\")\n  else NA\n})\n\nunique(na.omit(data_ex$sports_para))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n [1] \"Para athlétisme\"                  \"Para cyclisme sur piste\"         \n [3] \"Tennis fauteuil\"                  \"Para cyclisme sur route\"         \n [5] \"Para tennis de table\"             \"Basket fauteuil\"                 \n [7] \"Volley-ball assis\"                \"Goalball\"                        \n [9] \"Para judo,Rugby fauteuil\"         \"Para natation\"                   \n[11] \"Para canoë,Para aviron\"           \"Boccia\"                          \n[13] \"Cécifoot\"                         \"Para Badminton,Para powerlifting\"\n[15] \"Para équitation\"                  \"Escrime fauteuil,Para taekwondo\" \n[17] \"Para tir à l'arc\"                \n```\n:::\n:::\n\n\nLes disciplines para-olympiques accueillies sont Para athlétisme, Para cyclisme sur piste, Tennis fauteuil, Para cyclisme sur route, Para tennis de table, Basket fauteuil, Volley-ball assis, Goalball, Para judo,Rugby fauteuil, Para natation, Para canoë,Para aviron, Boccia, Cécifoot, Para Badminton, Para powerlifting, Para équitation, Escrime fauteuil Para taekwondo et Para tir à l'arc\n\n## Question 7\n\n### Sites avec le plus de disciplines différentes :\n\n\n::: {.cell}\n\n```{.r .cell-code}\n#Séparation des sports et calcul du nombre de sports\nnb_sports <- sapply(strsplit(as.character(data_ex$sports),\",\"), length)\n\n#Mettre en ordre décroissant le nombre de sports\nordre <- order(-nb_sports)\n\n#Sortir le noms des sites et des sports selon l'ordre établis\ndata_ex[ordre,]\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n             geo_point                                             nom\n10 48.838649, 2.378496                                     Arena Bercy\n11 48.971314, 2.519183                                Arena Paris nord\n13 48.865589, 2.321205                            Stade de la Concorde\n15 48.854536, 2.300413                            Arena Champs de Mars\n17 48.862229, 2.636374                                  Stade nautique\n21 48.899483, 2.361803                               Arena La Chapelle\n29 48.866041, 2.312406                                    Grand Palais\n30 48.862286, 2.313222                                       Invalides\n2  48.924388, 2.359871                                 Stade de France\n5   48.84732, 2.245501                             Stade Roland Garros\n12 48.829624, 2.290777         Arena Paris Sud 6 (Porte de Versailles)\n16   48.89566, 2.22971                                La Défense Arena\n23 48.923457, 2.355527                                Centre aquatique\n25  48.815115, 2.08208                           Château de Versailles\n4  48.788046, 2.034987 Vélodrome National de Saint-Quentin-en-Yvelines\n7  48.830231, 2.289126         Arena Paris Sud 4 (Porte de Versailles)\n9    48.856262, 2.2914                                     Pont d'Iéna\n18 48.832068, 2.284126         Arena Paris Sud 1 (Porte de Versailles)\n19 48.857232, 2.296084                               Stade Tour Eiffel\n1  48.841319, 2.253076                                Parc des Princes\n3    48.751095, 2.0759                                   Golf national\n6  48.911184, 2.546395                                Clichy-sous-Bois\n8  48.856858, 2.351415                         Hôtel de ville de Paris\n14 48.930873, 2.249836                            Stade Yves du Manoir\n20 48.787261, 2.034736          Stade BMX de Saint-Quentin-en-Yvelines\n22 48.835157, 2.257363                       Stade Pierre de Coubertin\n27 48.944643, 2.408258             Terrain des Essences - La Courneuve\n28 48.788162, 1.967776                             Colline d'Elancourt\n31 48.937188, 2.420467                      Site d'escalade du Bourget\n24  48.92467, 2.332428                               Village olympique\n26 48.944207, 2.424716                              Village des médias\n     sites_olympiques_paralympiques\n10 Site olympique,Site paralympique\n11 Site olympique,Site paralympique\n13                   Site olympique\n15 Site olympique,Site paralympique\n17 Site olympique,Site paralympique\n21 Site olympique,Site paralympique\n29 Site olympique,Site paralympique\n30 Site olympique,Site paralympique\n2  Site olympique,Site paralympique\n5  Site olympique,Site paralympique\n12 Site olympique,Site paralympique\n16 Site olympique,Site paralympique\n23                   Site olympique\n25 Site olympique,Site paralympique\n4  Site olympique,Site paralympique\n7  Site olympique,Site paralympique\n9                    Site olympique\n18 Site olympique,Site paralympique\n19 Site olympique,Site paralympique\n1                    Site olympique\n3                    Site olympique\n6                 Site paralympique\n8                    Site olympique\n14                   Site olympique\n20                   Site olympique\n22                Site paralympique\n27                Site paralympique\n28                   Site olympique\n31                   Site olympique\n24                                 \n26                                 \n                                                             sports\n10     Basketball,Basket fauteuil,Gymnastique artistique,trampoline\n11                Boxe,Escrime,Pentathlon moderne,Volley-ball assis\n13                 Basketball 3x3,BMX freestyle,Breaking,Skateboard\n15                              Judo,Para judo,Lutte,Rugby fauteuil\n17                              Canoë,Para canoë,Aviron,Para aviron\n21 Badminton,Para Badminton,Gymnastique rythmique,Para powerlifting\n29                Escrime,Escrime fauteuil,Taekwondo,Para taekwondo\n30       Tir à l'arc,Para tir à l'arc,Athlétisme,Cyclisme sur route\n2                                  Athlétisme,Para athlétisme,Rugby\n5                                       Tennis,Tennis fauteuil,Boxe\n12                                  Haltérophilie,Handball,Goalball\n16                                Natation,Para natation,Water-polo\n23                          Natation artistique,Plongeon,Water-polo\n25              Sports équestres,Para équitation,Pentathlon moderne\n4                        Cyclisme sur piste,Para cyclisme sur piste\n7                              Tennis de table,Para tennis de table\n9                                     Cyclisme sur route,Athlétisme\n18                                                Volleyball,Boccia\n19                                     Volleyball de plage,Cécifoot\n1                                                          Football\n3                                                              Golf\n6                                           Para cyclisme sur route\n8                                                        Athlétisme\n14                                                           Hockey\n20                                                         BMX race\n22                                                         Goalball\n27                                                  Para athlétisme\n28                                                              VTT\n31                                                Escalade sportive\n24                                                                 \n26                                                                 \n                        sports_para\n10                  Basket fauteuil\n11                Volley-ball assis\n13                             <NA>\n15         Para judo,Rugby fauteuil\n17           Para canoë,Para aviron\n21 Para Badminton,Para powerlifting\n29  Escrime fauteuil,Para taekwondo\n30                 Para tir à l'arc\n2                   Para athlétisme\n5                   Tennis fauteuil\n12                         Goalball\n16                    Para natation\n23                             <NA>\n25                  Para équitation\n4           Para cyclisme sur piste\n7              Para tennis de table\n9                              <NA>\n18                           Boccia\n19                         Cécifoot\n1                              <NA>\n3                              <NA>\n6           Para cyclisme sur route\n8                              <NA>\n14                             <NA>\n20                             <NA>\n22                         Goalball\n27                  Para athlétisme\n28                             <NA>\n31                             <NA>\n24                             <NA>\n26                             <NA>\n```\n:::\n:::\n\n\nLes sites qui acceuillent le plus de disciplines différentes sont l'Arena Bercy, l'Arena Paris nord, le Stade de la Concorde, l'Arena Champs de Mars, le Stade nautique, l'Arena La Chapelle, le Grand Palais et les Invalides.\n\n## Question 8\n\n### Discipline qui aura lieu sur le plus grand nombre de sites :\n\n\n::: {.cell}\n\n```{.r .cell-code}\nnames(sort(table(unlist(strsplit(data_ex$sports, \",\"))), decreasing = TRUE))[1]\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"Athlétisme\"\n```\n:::\n:::\n\n\nLe sport qui a lieu sur le plus de sites est l'athlétisme.\n\n### Sites qui accueillent cette discipline :\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsubset(data_ex, grepl(\"Athlétisme\", sports))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n             geo_point                     nom   sites_olympiques_paralympiques\n2  48.924388, 2.359871         Stade de France Site olympique,Site paralympique\n8  48.856858, 2.351415 Hôtel de ville de Paris                   Site olympique\n9    48.856262, 2.2914             Pont d'Iéna                   Site olympique\n30 48.862286, 2.313222               Invalides Site olympique,Site paralympique\n                                                       sports      sports_para\n2                            Athlétisme,Para athlétisme,Rugby  Para athlétisme\n8                                                  Athlétisme             <NA>\n9                               Cyclisme sur route,Athlétisme             <NA>\n30 Tir à l'arc,Para tir à l'arc,Athlétisme,Cyclisme sur route Para tir à l'arc\n```\n:::\n:::\n\n\nL'athlétisme aura lieu au stade de France, à l'hôtel de ville de Paris, le Pont d'Iéna et les invalides.\n\n## Question 9\n\n### Les deux sites les plus proches à vol d'oiseau :\n\n\n::: {.cell}\n\n```{.r .cell-code}\n#Créer une colonne pour la latitude et la longitude\ndata_ex$geo_point <- strsplit(as.character(data_ex$geo_point), \",\", fixed = TRUE)\ndata_ex$latitude <- as.numeric(sapply(data_ex$geo_point, function(x) x[1]))\ndata_ex$longitude <- as.numeric(sapply(data_ex$geo_point, function(x) x[2]))\n\n#Créer une matrice pour pouvoir stocker les distance\ndistances_matrix <- matrix(NA, nrow = nrow(data_ex), ncol = nrow(data_ex), dimnames = list(data_ex$nom, data_ex$nom))\n\n#Calcul des distance entre les sites\nfor (i in 1:(nrow(data_ex)-1)) {\n  for (j in (i+1):nrow(data_ex)) {\n    distance <- distHaversine(\n      p1 = c(data_ex$latitude[i], data_ex$longitude[i]),\n      p2 = c(data_ex$latitude[j], data_ex$longitude[j])\n    )\n    distances_matrix[i, j] <- distance\n    distances_matrix[j, i] <- distance\n  }\n}\n\n# Trouver les deux sites les plus proches\nmin_distance <- min(distances_matrix[distances_matrix > 0], na.rm = TRUE)\nsites_proches <- which(distances_matrix == min_distance, arr.ind = TRUE)\n\n# Afficher les résultats\nrownames(distances_matrix)[sites_proches[1, 1]]\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"Stade BMX de Saint-Quentin-en-Yvelines\"\n```\n:::\n\n```{.r .cell-code}\nrownames(distances_matrix)[sites_proches[1, 2]]\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"Vélodrome National de Saint-Quentin-en-Yvelines\"\n```\n:::\n\n```{.r .cell-code}\nmin_distance\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 91.69166\n```\n:::\n:::\n\n\nLes deux sites les plus proches sont le Stade BMX de Saint-Quentin-en-Yvelines et le Vélodrome National de Saint-Quentin-en-Yvelines.\n\n## Question 10\n\n### Les deux sites les plus éloignés\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Trouver les deux sites les plus éloignés\nmax_distance <- max(distances_matrix[distances_matrix > 0], na.rm = TRUE)\nsites_eloignes <- which(distances_matrix == max_distance, arr.ind = TRUE)\n\n# Afficher les résultats\nrownames(distances_matrix)[sites_eloignes [1,1]]\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"Colline d'Elancourt\"\n```\n:::\n\n```{.r .cell-code}\nrownames(distances_matrix)[sites_eloignes [1,2]]\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"Stade nautique\"\n```\n:::\n\n```{.r .cell-code}\nmax_distance\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 74882.55\n```\n:::\n:::\n\n\nLes deux sites les plus éloignés sont la colline d'Elancourt et le stade nautique.\n\n## Question 11\n\n### Appartement situé au barycentre de l'ensemble des sites olympiques.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nbarycentre_latitude <- weighted.mean(data_ex$latitude, w = rep(1, nrow(data_ex)))\nbarycentre_longitude <- weighted.mean(data_ex$longitude, w = rep(1, nrow(data_ex)))\n\ncoordonnees_tibble <- tibble::tibble(\n  lon = barycentre_longitude,\n  lat = barycentre_latitude\n)\n\n# Utiliser reverse_geocode pour obtenir le nom de l'adresse\nresultat <- tidygeocoder::reverse_geocode(coordonnees_tibble, lon = \"lon\", lat = \"lat\")\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nPassing 1 coordinate to the Nominatim single coordinate geocoder\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nQuery completed in: 1 seconds\n```\n:::\n\n```{.r .cell-code}\n# Afficher le résultat\nresultat$address\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"23, Avenue Pierre 1er de Serbie, Quartier de Chaillot, Paris 16e Arrondissement, Paris, Île-de-France, France métropolitaine, 75116, France\"\n```\n:::\n:::\n\n\nL'appartement au barycentre de l'ensemble des sites olympiques se situe au 23, Avenue Pierre 1er de Serbie, Quartier de Chaillot, Paris 16e Arrondissement, Paris, Île-de-France, France métropolitaine, 75116, France.\n\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}